version: '2'
volumes:
    resin-data:
services:
  helloworld:
    image: resin/raspberrypi3-python:slim
    volumes:
      - 'resin-data:/data'
    command: |
      /bin/bash -c "
      while true; do
        date >> /data/helloworld.txt
        echo \"Sleeping\"
        sleep 60
      done"
  fluentd:
    build: ./fluentd
    expose:
      - 24224
      - 5140
    volumes:
      - 'resin-data:/data'
  speedtest:
    build: ./speedtest
    depends_on:
      - fluentd
    logging:
      driver: fluentd
      options:
        tag: "speedtest.telecolumbus"
